{"type":"group","name":"fullsense relaying","enabled":false,"id":1,"items":[{"type":"function","name":"onLoad","enabled":true,"id":116,"code":"//Enter the function here\nprinting_sense = false;\nsense_detected = [];"},{"type":"alias","name":"","enabled":true,"id":115,"matching":"exact","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"function","fn":"onLoad"}],"text":"load sense"},{"type":"group","name":"Fullsense","enabled":true,"id":112,"items":[{"type":"alias","name":"Fullsense","enabled":true,"id":114,"matching":"exact","whole_words":true,"case_sensitive":true,"prefix_suffix":true,"actions":[{"action":"script","script":"//Enter the script here\nlet cstr = 'setalias mangorize stand/fullsense';\n\neqbal_action(cstr, 'mangorize');\n\nprinting_sense = true;"}],"text":"fsense","items":[]},{"type":"trigger","name":"","enabled":true,"id":110,"matching":"exact","whole_words":true,"case_sensitive":true,"text":"Focusing your every sense, you scour the area for traces of others:","actions":[{"action":"script","script":"//Enter the script here\nsense_detected = [];\nsense_relayed = false;\nif (printing_sense)\n    gag_current_line();"}],"items":[]},{"type":"trigger","name":"Get Detected People Lines","enabled":true,"id":111,"matching":"regexp","whole_words":true,"case_sensitive":true,"text":"^You sense (\\w+) at (.+)\\.$","actions":[{"action":"script","script":"//Enter the script here\nfsense_magic = function() {\n    \nconst groupBy = key => array =>\n  array.reduce(\n    (objectsByKeyValue, obj) => ({\n      ...objectsByKeyValue,\n      [obj[key]]: (objectsByKeyValue[obj[key]] || []).concat(obj)\n    }),\n    {}\n);\n\nconst groupByLocation = groupBy('location');\n\nconst filtered = groupByLocation(sense_detected);\n\nlet cstr = '';\nfor (let location in filtered) {\n    let num_people = Object.keys(filtered[location]).length;\n    cstr += '/pt ['+num_people+']: ';\n    for (let idx = 0; idx < num_people; idx++)\n        if (idx < num_people - 1)\n        \tcstr += filtered[location][idx].name+', ';\n    \telse\n            cstr += filtered[location][idx].name+'. ';\n    \n    cstr += '['+location+']';\n}\n\nif (!sense_relayed && printing_sense) {\n\tsend_command('setalias fufunot pt FULLSENSE INFO:/'+cstr);\n\tsend_command(\"fufunot\");\n    sense_relayed = true;\n}\n\nprinting_sense = false;\n    \n}\n\n\ndetected_person = {'name': args[1], 'location': args[2]};\nsense_detected.push(detected_person);\n\nif (printing_sense)\n    gag_current_line();\n\nsetTimeout(fsense_magic, 10);"}],"items":[]}],"actions":[]}],"description":"Exported reflexes: Fullsense Relaying"}